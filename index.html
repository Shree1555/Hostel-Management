<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HostelHub - Enhanced Management System</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- SheetJS for Excel export -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&family=Archivo+Black&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #1E40AF;
            --primary-dark: #1E3A8A;
            --secondary: #7C3AED;
            --accent: #F59E0B;
            --success: #10B981;
            --danger: #EF4444;
            --warning: #F59E0B;
            --bg: #F9FAFB;
            --card-bg: #FFFFFF;
            --text: #111827;
            --text-muted: #6B7280;
            --border: #E5E7EB;
            --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'Poppins', -apple-system, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
        }

        .app {
            max-width: 480px;
            margin: 0 auto;
            min-height: 100vh;
            background: var(--card-bg);
            box-shadow: 0 0 60px rgba(0,0,0,0.08);
            position: relative;
        }

        h1, h2, h3 {
            font-family: 'Archivo Black', sans-serif;
            font-weight: 900;
            line-height: 1.2;
            letter-spacing: -0.02em;
        }

        /* Welcome & Login Screens */
        .welcome-screen, .login-screen {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 2rem;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            position: relative;
            overflow: hidden;
        }

        .welcome-screen::before, .login-screen::before {
            content: '';
            position: absolute;
            top: -10%;
            right: -20%;
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, rgba(245, 158, 11, 0.2) 0%, transparent 70%);
            border-radius: 50%;
            animation: pulse 4s infinite ease-in-out;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.5; }
            50% { transform: scale(1.2); opacity: 0.8; }
        }

        .welcome-content, .login-content {
            position: relative;
            z-index: 1;
        }

        .logo {
            text-align: center;
            margin-bottom: 2rem;
        }

        .logo-icon {
            width: 90px;
            height: 90px;
            background: linear-gradient(135deg, var(--accent) 0%, #FCD34D 100%);
            border-radius: 24px;
            margin: 0 auto 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 45px;
            box-shadow: 0 20px 40px rgba(245, 158, 11, 0.4);
            animation: float 3s infinite ease-in-out;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .logo h1 {
            color: white;
            font-size: 2.25rem;
            margin-bottom: 0.5rem;
            text-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .logo p {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1rem;
            font-weight: 500;
        }

        .welcome-buttons {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-top: 2rem;
        }

        .login-form, .onboarding-form {
            background: white;
            padding: 2rem;
            border-radius: 24px;
            box-shadow: var(--shadow-lg);
        }

        /* Onboarding */
        .onboarding-screen {
            min-height: 100vh;
            background: var(--bg);
            padding-bottom: 2rem;
        }

        .onboarding-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            padding: 2rem 1.5rem;
            color: white;
            text-align: center;
        }

        .onboarding-header h2 {
            font-size: 1.75rem;
            margin-bottom: 0.5rem;
        }

        .step-indicator {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-bottom: 2rem;
        }

        .step-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--border);
            transition: all 0.3s;
        }

        .step-dot.active {
            width: 30px;
            border-radius: 5px;
            background: var(--primary);
        }

        .step-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: var(--shadow-lg);
            margin: 0 1.5rem 1.5rem;
        }

        /* Forms */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text);
            font-size: 0.9rem;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 1rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 1rem;
            font-family: inherit;
            transition: all 0.3s;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        .form-hint {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: 0.5rem;
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 1rem 1.5rem;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 700;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            white-space: nowrap;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            width: 100%;
            box-shadow: 0 4px 12px rgba(30, 64, 175, 0.3);
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(30, 64, 175, 0.4);
        }

        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .btn-white {
            background: white;
            color: var(--primary);
            width: 100%;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .btn-secondary {
            background: var(--bg);
            color: var(--text);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.85rem;
        }

        /* Header */
        .header {
            padding: 1.5rem;
            background: var(--card-bg);
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.95);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .menu-btn {
            background: transparent;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 8px;
        }

        .menu-btn:hover {
            background: var(--bg);
        }

        /* Dashboard */
        .dashboard {
            padding-bottom: 5rem;
        }

        .greeting {
            padding: 2rem 1.5rem;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            position: relative;
            overflow: hidden;
        }

        .greeting::after {
            content: '';
            position: absolute;
            bottom: -50px;
            right: -50px;
            width: 150px;
            height: 150px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
        }

        .greeting-content {
            position: relative;
            z-index: 1;
        }

        .greeting h1 {
            font-size: 1.75rem;
            margin-bottom: 0.5rem;
        }

        .greeting p {
            opacity: 0.95;
            font-size: 0.95rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            padding: 1.5rem;
            margin-top: -2rem;
        }

        .stat-card {
            background: var(--card-bg);
            padding: 1.5rem;
            border-radius: 16px;
            box-shadow: var(--shadow);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
        }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }

        .stat-icon {
            width: 48px;
            height: 48px;
            background: var(--bg);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-bottom: 1rem;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 800;
            font-family: 'Archivo Black', sans-serif;
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-top: 0.25rem;
            font-weight: 500;
        }

        /* Quick Actions */
        .quick-actions {
            padding: 0 1.5rem 1.5rem;
        }

        .section-title {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }

        .action-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .action-card {
            background: var(--card-bg);
            padding: 1.25rem;
            border-radius: 16px;
            box-shadow: var(--shadow);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .action-card:hover {
            border-color: var(--primary);
            transform: scale(1.05);
        }

        .action-icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .action-label {
            font-size: 0.9rem;
            font-weight: 600;
        }

        /* Rooms Grid */
        .rooms-container, .residents-list, .payment-list, .users-list, .expenses-list, .reports-container {
            padding: 1.5rem;
            padding-bottom: 5rem;
        }

        .floor-section {
            margin-bottom: 2rem;
        }

        .floor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: var(--bg);
            border-radius: 12px;
            margin-bottom: 1rem;
        }

        .floor-title {
            font-size: 1.1rem;
            font-weight: 700;
        }

        .floor-stats {
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .rooms-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .room-card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 1.25rem;
            box-shadow: var(--shadow);
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .room-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }

        .room-card.full {
            border-color: var(--danger);
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.05) 0%, rgba(239, 68, 68, 0.02) 100%);
        }

        .room-card.available {
            border-color: var(--success);
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.05) 0%, rgba(16, 185, 129, 0.02) 100%);
        }

        .room-number {
            font-size: 1.5rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
        }

        .room-type {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            font-weight: 600;
        }

        .beds-indicator {
            display: flex;
            gap: 0.25rem;
            margin-top: 0.75rem;
            flex-wrap: wrap;
        }

        .bed {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 700;
        }

        .bed.occupied {
            background: var(--danger);
            color: white;
        }

        .bed.available {
            background: var(--bg);
            color: var(--text-muted);
            border: 2px dashed var(--border);
        }

        .room-rent {
            font-size: 1rem;
            font-weight: 700;
            color: var(--primary);
            margin-top: 0.75rem;
        }

        /* Resident Card */
        .resident-card, .user-card, .expense-card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 1.25rem;
            margin-bottom: 1rem;
            box-shadow: var(--shadow);
            display: flex;
            align-items: start;
            gap: 1rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .resident-card:hover, .user-card:hover, .expense-card:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-2px);
        }

        .resident-avatar, .user-avatar, .expense-icon-circle {
            width: 56px;
            height: 56px;
            border-radius: 16px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            font-weight: 700;
            flex-shrink: 0;
        }

        .resident-info, .user-info, .expense-info {
            flex: 1;
        }

        .resident-name, .user-name, .expense-title {
            font-size: 1rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .resident-room, .user-role, .expense-category {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-bottom: 0.5rem;
        }

        .resident-status {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .status-paid {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .status-pending {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }

        .status-overdue {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }

        .role-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .role-owner {
            background: rgba(124, 58, 237, 0.1);
            color: var(--secondary);
        }

        .role-manager {
            background: rgba(30, 64, 175, 0.1);
            color: var(--primary);
        }

        .role-staff {
            background: rgba(100, 116, 139, 0.1);
            color: var(--text-muted);
        }

        /* Payment Summary */
        .payment-summary {
            padding: 1.5rem;
            background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
            color: white;
        }

        .payment-amount {
            font-size: 2.5rem;
            font-weight: 900;
            margin-bottom: 0.5rem;
        }

        .payment-breakdown {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .breakdown-item {
            text-align: center;
        }

        .breakdown-value {
            font-size: 1.25rem;
            font-weight: 700;
        }

        .breakdown-label {
            font-size: 0.75rem;
            opacity: 0.9;
            margin-top: 0.25rem;
        }

        .payment-card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 1.25rem;
            margin-bottom: 1rem;
            box-shadow: var(--shadow);
        }

        .payment-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 1rem;
        }

        .payment-resident {
            font-size: 1rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .payment-room {
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .payment-amount-card {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--primary);
        }

        .payment-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border);
        }

        .detail-item {
            display: flex;
            flex-direction: column;
        }

        .detail-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-bottom: 0.25rem;
            font-weight: 500;
        }

        .detail-value {
            font-size: 0.9rem;
            font-weight: 600;
        }

        /* Report Card */
        .report-card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: var(--shadow);
        }

        .report-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .report-title {
            font-size: 1.25rem;
            font-weight: 700;
        }

        .report-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .report-stat {
            padding: 1rem;
            background: var(--bg);
            border-radius: 12px;
        }

        .report-stat-label {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-bottom: 0.5rem;
        }

        .report-stat-value {
            font-size: 1.5rem;
            font-weight: 700;
        }

        /* Bottom Nav */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            max-width: 480px;
            width: 100%;
            background: var(--card-bg);
            border-top: 1px solid var(--border);
            padding: 0.75rem 0.5rem;
            display: flex;
            justify-content: space-around;
            box-shadow: 0 -4px 12px rgba(0,0,0,0.05);
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.25rem;
            padding: 0.5rem 0.75rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            color: var(--text-muted);
            font-size: 0.7rem;
            font-weight: 600;
            border: none;
            background: transparent;
            font-family: inherit;
            position: relative;
        }

        .nav-item.active {
            color: var(--primary);
            background: rgba(30, 64, 175, 0.1);
        }

        .nav-item .icon {
            font-size: 1.4rem;
        }

        .notification-badge {
            position: absolute;
            top: 4px;
            right: 8px;
            background: var(--danger);
            color: white;
            font-size: 0.65rem;
            padding: 0.15rem 0.35rem;
            border-radius: 10px;
            font-weight: 700;
        }

        /* Modals */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            display: flex;
            align-items: flex-end;
            justify-content: center;
            z-index: 1000;
            animation: fadeIn 0.2s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal {
            background: var(--card-bg);
            width: 100%;
            max-width: 480px;
            border-radius: 24px 24px 0 0;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.3s;
        }

        @keyframes slideUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            background: var(--card-bg);
            z-index: 1;
        }

        .modal-header h3 {
            font-size: 1.25rem;
        }

        .modal-body {
            padding: 1.5rem;
        }

        .close-btn {
            background: transparent;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-muted);
            padding: 0.5rem;
            border-radius: 8px;
        }

        .close-btn:hover {
            background: var(--bg);
        }

        /* Settings Menu */
        .settings-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            z-index: 1000;
            animation: fadeIn 0.2s;
        }

        .settings-menu {
            position: fixed;
            top: 0;
            right: 0;
            bottom: 0;
            width: 80%;
            max-width: 320px;
            background: var(--card-bg);
            box-shadow: -4px 0 12px rgba(0,0,0,0.15);
            z-index: 1001;
            animation: slideInRight 0.3s;
            overflow-y: auto;
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }

        .settings-header {
            padding: 2rem 1.5rem;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
        }

        .settings-header h3 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .settings-section {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
        }

        .settings-section h4 {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-bottom: 1rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .settings-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 0.5rem;
        }

        .settings-item:hover {
            background: var(--bg);
        }

        .settings-icon {
            font-size: 1.5rem;
            width: 40px;
            text-align: center;
        }

        .settings-text h5 {
            font-size: 0.95rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .settings-text p {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        /* FAB */
        .fab {
            position: fixed;
            bottom: 5.5rem;
            right: 1rem;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            border-radius: 50%;
            border: none;
            box-shadow: 0 8px 24px rgba(30, 64, 175, 0.4);
            font-size: 2rem;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            z-index: 10;
        }

        .fab:hover {
            transform: scale(1.1) rotate(90deg);
            box-shadow: 0 12px 32px rgba(30, 64, 175, 0.5);
        }

        /* Toast */
        .toast {
            position: fixed;
            top: 1rem;
            left: 50%;
            transform: translateX(-50%);
            background: var(--success);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
            z-index: 2000;
            animation: slideDown 0.3s;
            font-weight: 600;
            max-width: 90%;
        }

        @keyframes slideDown {
            from { transform: translateX(-50%) translateY(-100%); opacity: 0; }
            to { transform: translateX(-50%) translateY(0); opacity: 1; }
        }

        .toast.error {
            background: var(--danger);
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 3rem 2rem;
        }

        .empty-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.3;
        }

        .empty-state h3 {
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
        }

        .empty-state p {
            color: var(--text-muted);
            margin-bottom: 1.5rem;
        }

        /* Bed Selector */
        .bed-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-top: 1rem;
        }

        .bed-selector {
            padding: 1rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }

        .bed-selector.occupied {
            background: rgba(239, 68, 68, 0.05);
            border-color: var(--danger);
            cursor: not-allowed;
        }

        .bed-selector.selected {
            background: rgba(30, 64, 175, 0.1);
            border-color: var(--primary);
        }

        .bed-number {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .bed-status-text {
            font-size: 0.75rem;
            color: var(--text-muted);
            font-weight: 600;
        }

        /* Utility */
        .text-center { text-align: center; }
        .mt-1 { margin-top: 0.5rem; }
        .mt-2 { margin-top: 1rem; }
        .mb-1 { margin-bottom: 0.5rem; }
        .mb-2 { margin-bottom: 1rem; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Load/Save data
        const loadData = () => {
            const saved = localStorage.getItem('hostelhub_enhanced');
            return saved ? JSON.parse(saved) : null;
        };

        const saveData = (data) => {
            localStorage.setItem('hostelhub_enhanced', JSON.stringify(data));
        };

        // Export to Excel function
        const exportToExcel = (systemData) => {
            // Prepare data for export
            const wb = XLSX.utils.book_new();

            // Hostel Info Sheet
            const hostelData = [[
                'Hostel Name', systemData.hostel.name
            ], [
                'Location', systemData.hostel.location
            ], [
                'Type', systemData.hostel.hostelType
            ], [
                'Address', systemData.hostel.address || 'N/A'
            ]];
            const hostelSheet = XLSX.utils.aoa_to_sheet(hostelData);
            XLSX.utils.book_append_sheet(wb, hostelSheet, 'Hostel Info');

            // Rooms Sheet
            const roomsData = systemData.rooms.map(room => ({
                'Room Number': room.number,
                'Floor': room.floor,
                'Type': room.type,
                'Total Beds': room.totalBeds,
                'Occupied Beds': room.beds.filter(b => b.occupied).length,
                'Rent per Bed': room.rent
            }));
            const roomsSheet = XLSX.utils.json_to_sheet(roomsData);
            XLSX.utils.book_append_sheet(wb, roomsSheet, 'Rooms');

            // Residents Sheet
            const residentsData = systemData.residents.map(resident => {
                const room = systemData.rooms.find(r => r.id === resident.roomId);
                return {
                    'Name': resident.name,
                    'Room': room?.number || 'N/A',
                    'Bed': resident.bedNumber,
                    'Phone': resident.phone,
                    'Guardian Name': resident.guardianName,
                    'Guardian Phone': resident.guardianPhone,
                    'Join Date': resident.joinDate,
                    'Room Rent': resident.rent,
                    'Mess Charges': resident.messCharges,
                    'Total': resident.rent + resident.messCharges,
                    'Payment Status': resident.paymentStatus,
                    'Last Payment': resident.lastPayment || 'N/A'
                };
            });
            const residentsSheet = XLSX.utils.json_to_sheet(residentsData);
            XLSX.utils.book_append_sheet(wb, residentsSheet, 'Residents');

            // Expenses Sheet
            if (systemData.expenses && systemData.expenses.length > 0) {
                const expensesData = systemData.expenses.map(expense => ({
                    'Date': expense.date,
                    'Category': expense.category,
                    'Amount': expense.amount,
                    'Description': expense.description || 'N/A'
                }));
                const expensesSheet = XLSX.utils.json_to_sheet(expensesData);
                XLSX.utils.book_append_sheet(wb, expensesSheet, 'Expenses');
            }

            // Users Sheet (only for owners)
            const usersData = systemData.users.map(user => ({
                'Name': user.name,
                'Role': user.role,
                'Mobile': user.mobile,
                'Email': user.email || 'N/A',
                'Username': user.username
            }));
            const usersSheet = XLSX.utils.json_to_sheet(usersData);
            XLSX.utils.book_append_sheet(wb, usersSheet, 'Users');

            // Generate file
            const timestamp = new Date().toISOString().split('T')[0];
            XLSX.writeFile(wb, `HostelHub_Backup_${timestamp}.xlsx`);
        };

        function App() {
            const [systemData, setSystemData] = useState(loadData());
            const [currentScreen, setCurrentScreen] = useState('welcome');
            const [isLoggedIn, setIsLoggedIn] = useState(false);
            const [currentUser, setCurrentUser] = useState(null);
            const [toast, setToast] = useState(null);
            const [showSettings, setShowSettings] = useState(false);
            const [showModal, setShowModal] = useState(null);
            const [selectedItem, setSelectedItem] = useState(null);

            useEffect(() => {
                if (systemData) {
                    saveData(systemData);
                }
            }, [systemData]);

            useEffect(() => {
                if (systemData && !isLoggedIn) {
                    setCurrentScreen('login');
                } else if (!systemData) {
                    setCurrentScreen('welcome');
                }
            }, [systemData, isLoggedIn]);

            const showToast = (message, type = 'success') => {
                setToast({ message, type });
                setTimeout(() => setToast(null), 3000);
            };

            const handleOnboarding = (hostelData, ownerData) => {
                const newSystem = {
                    hostel: hostelData,
                    users: [{
                        ...ownerData,
                        id: Date.now(),
                        createdAt: new Date().toISOString()
                    }],
                    rooms: [],
                    residents: [],
                    expenses: [],
                    paymentReminders: [],
                    createdAt: new Date().toISOString()
                };
                setSystemData(newSystem);
                showToast('Hostel setup completed!');
                setCurrentScreen('login');
            };

            const handleLogin = (username, password) => {
                if (!systemData) {
                    showToast('No hostel data found', 'error');
                    return false;
                }

                const user = systemData.users.find(
                    u => u.username === username && u.password === password
                );

                if (user) {
                    setCurrentUser(user);
                    setIsLoggedIn(true);
                    setCurrentScreen('dashboard');
                    showToast(`Welcome back, ${user.name}!`);
                    return true;
                }

                showToast('Invalid username or password', 'error');
                return false;
            };

            const handleLogout = () => {
                setIsLoggedIn(false);
                setCurrentUser(null);
                setCurrentScreen('login');
                setShowSettings(false);
                showToast('Logged out successfully');
            };

            const addUser = (userData) => {
                const newUser = {
                    ...userData,
                    id: Date.now(),
                    createdAt: new Date().toISOString()
                };
                setSystemData({
                    ...systemData,
                    users: [...systemData.users, newUser]
                });
                setShowModal(null);
                showToast(`User ${userData.name} added successfully`);
            };

            const deleteUser = (userId) => {
                if (userId === currentUser.id) {
                    showToast('Cannot delete your own account', 'error');
                    return;
                }
                if (confirm('Are you sure you want to delete this user?')) {
                    setSystemData({
                        ...systemData,
                        users: systemData.users.filter(u => u.id !== userId)
                    });
                    setSelectedItem(null);
                    setShowModal(null);
                    showToast('User deleted successfully');
                }
            };

            const changePassword = (oldPassword, newPassword) => {
                if (currentUser.password !== oldPassword) {
                    showToast('Current password is incorrect', 'error');
                    return false;
                }

                setSystemData({
                    ...systemData,
                    users: systemData.users.map(u =>
                        u.id === currentUser.id ? { ...u, password: newPassword } : u
                    )
                });

                setCurrentUser({ ...currentUser, password: newPassword });
                setShowModal(null);
                showToast('Password changed successfully');
                return true;
            };

            const addRoom = (roomData) => {
                const newRoom = {
                    ...roomData,
                    id: Date.now(),
                    beds: Array.from({ length: roomData.totalBeds }, (_, i) => ({
                        bedNumber: i + 1,
                        occupied: false,
                        residentId: null
                    }))
                };
                setSystemData({
                    ...systemData,
                    rooms: [...systemData.rooms, newRoom]
                });
                setShowModal(null);
                showToast('Room added successfully');
            };

            const addResident = (residentData, roomId, bedNumber) => {
                const newResident = {
                    ...residentData,
                    id: Date.now(),
                    roomId,
                    bedNumber,
                    joinDate: residentData.joinDate || new Date().toISOString().split('T')[0],
                    paymentStatus: 'pending',
                    lastPayment: ''
                };

                const updatedRooms = systemData.rooms.map(room => {
                    if (room.id === roomId) {
                        return {
                            ...room,
                            beds: room.beds.map(bed =>
                                bed.bedNumber === bedNumber
                                    ? { ...bed, occupied: true, residentId: newResident.id }
                                    : bed
                            )
                        };
                    }
                    return room;
                });

                setSystemData({
                    ...systemData,
                    residents: [...systemData.residents, newResident],
                    rooms: updatedRooms
                });
                setShowModal(null);
                showToast('Resident added successfully');
            };

            const terminateResident = (residentId) => {
                if (!confirm('Are you sure you want to terminate this resident? This will free up their bed.')) {
                    return;
                }

                const resident = systemData.residents.find(r => r.id === residentId);
                if (!resident) return;

                // Free up the bed
                const updatedRooms = systemData.rooms.map(room => {
                    if (room.id === resident.roomId) {
                        return {
                            ...room,
                            beds: room.beds.map(bed =>
                                bed.bedNumber === resident.bedNumber
                                    ? { ...bed, occupied: false, residentId: null }
                                    : bed
                            )
                        };
                    }
                    return room;
                });

                // Remove resident
                setSystemData({
                    ...systemData,
                    residents: systemData.residents.filter(r => r.id !== residentId),
                    rooms: updatedRooms
                });

                setSelectedItem(null);
                setShowModal(null);
                showToast('Resident terminated and bed freed');
            };

            const markPayment = (residentId) => {
                setSystemData({
                    ...systemData,
                    residents: systemData.residents.map(r =>
                        r.id === residentId
                            ? { ...r, paymentStatus: 'paid', lastPayment: new Date().toISOString().split('T')[0] }
                            : r
                    )
                });
                showToast('Payment marked as paid');
            };

            const addExpense = (expenseData) => {
                const newExpense = {
                    ...expenseData,
                    id: Date.now(),
                    date: expenseData.date || new Date().toISOString().split('T')[0]
                };

                setSystemData({
                    ...systemData,
                    expenses: [...(systemData.expenses || []), newExpense]
                });
                setShowModal(null);
                showToast('Expense added successfully');
            };

            const handleBackup = () => {
                exportToExcel(systemData);
                showToast('Data exported to Excel successfully');
            };

            const getStats = () => {
                const totalBeds = systemData?.rooms.reduce((sum, r) => sum + r.totalBeds, 0) || 0;
                const occupiedBeds = systemData?.rooms.reduce(
                    (sum, r) => sum + r.beds.filter(b => b.occupied).length,
                    0
                ) || 0;
                const totalRevenue = systemData?.residents.reduce((sum, r) => sum + r.rent + r.messCharges, 0) || 0;
                const pendingPayments = systemData?.residents.filter(r => r.paymentStatus !== 'paid').length || 0;
                const totalExpenses = systemData?.expenses?.reduce((sum, e) => sum + e.amount, 0) || 0;

                return { totalBeds, occupiedBeds, totalRevenue, pendingPayments, totalExpenses };
            };

            return (
                <div className="app">
                    {toast && (
                        <div className={`toast ${toast.type === 'error' ? 'error' : ''}`}>
                            {toast.message}
                        </div>
                    )}

                    {currentScreen === 'welcome' && (
                        <WelcomeScreen onGetStarted={() => setCurrentScreen('onboarding')} />
                    )}

                    {currentScreen === 'onboarding' && (
                        <OnboardingScreen
                            onComplete={handleOnboarding}
                            onBack={() => setCurrentScreen('welcome')}
                        />
                    )}

                    {currentScreen === 'login' && (
                        <LoginScreen
                            hostelName={systemData?.hostel?.name}
                            onLogin={handleLogin}
                        />
                    )}

                    {isLoggedIn && systemData && (
                        <>
                            {currentScreen === 'dashboard' && (
                                <Dashboard
                                    hostel={systemData.hostel}
                                    user={currentUser}
                                    stats={getStats()}
                                    onMenuClick={() => setShowSettings(true)}
                                    onAction={setShowModal}
                                    onNavigate={setCurrentScreen}
                                />
                            )}

                            {currentScreen === 'rooms' && (
                                <RoomsScreen
                                    rooms={systemData.rooms}
                                    residents={systemData.residents}
                                    onAdd={() => setShowModal('addRoom')}
                                    onRoomClick={(room) => {
                                        setSelectedItem(room);
                                        setShowModal('roomDetails');
                                    }}
                                />
                            )}

                            {currentScreen === 'residents' && (
                                <ResidentsScreen
                                    residents={systemData.residents}
                                    rooms={systemData.rooms}
                                    onAdd={() => setShowModal('addResident')}
                                    onResidentClick={(resident) => {
                                        setSelectedItem(resident);
                                        setShowModal('residentDetails');
                                    }}
                                />
                            )}

                            {currentScreen === 'payments' && (
                                <PaymentsScreen
                                    residents={systemData.residents}
                                    rooms={systemData.rooms}
                                    onMarkPaid={markPayment}
                                />
                            )}

                            {currentScreen === 'expenses' && (
                                <ExpensesScreen
                                    expenses={systemData.expenses || []}
                                    onAdd={() => setShowModal('addExpense')}
                                    onExpenseClick={(expense) => {
                                        setSelectedItem(expense);
                                        setShowModal('expenseDetails');
                                    }}
                                />
                            )}

                            {currentScreen === 'reports' && (
                                <ReportsScreen
                                    systemData={systemData}
                                    stats={getStats()}
                                />
                            )}

                            {currentScreen === 'users' && (
                                <UsersScreen
                                    users={systemData.users}
                                    currentUser={currentUser}
                                    onAdd={() => setShowModal('addUser')}
                                    onUserClick={(user) => {
                                        setSelectedItem(user);
                                        setShowModal('userDetails');
                                    }}
                                />
                            )}

                            <BottomNav
                                current={currentScreen}
                                onChange={setCurrentScreen}
                                pendingCount={getStats().pendingPayments}
                            />
                        </>
                    )}

                    {showSettings && (
                        <SettingsMenu
                            user={currentUser}
                            hostel={systemData.hostel}
                            onClose={() => setShowSettings(false)}
                            onLogout={handleLogout}
                            onBackup={handleBackup}
                            onChangePassword={() => setShowModal('changePassword')}
                            onNavigate={(screen) => {
                                setShowSettings(false);
                                setCurrentScreen(screen);
                            }}
                        />
                    )}

                    {/* Modals */}
                    {showModal === 'addUser' && currentUser.role === 'Owner' && (
                        <UserModal onClose={() => setShowModal(null)} onSave={addUser} />
                    )}

                    {showModal === 'addRoom' && (
                        <RoomModal onClose={() => setShowModal(null)} onSave={addRoom} />
                    )}

                    {showModal === 'addResident' && (
                        <ResidentModal
                            rooms={systemData.rooms}
                            onClose={() => setShowModal(null)}
                            onSave={addResident}
                        />
                    )}

                    {showModal === 'addExpense' && (
                        <ExpenseModal onClose={() => setShowModal(null)} onSave={addExpense} />
                    )}

                    {showModal === 'changePassword' && (
                        <ChangePasswordModal
                            onClose={() => setShowModal(null)}
                            onSave={changePassword}
                        />
                    )}

                    {showModal === 'roomDetails' && selectedItem && (
                        <RoomDetailsModal
                            room={selectedItem}
                            residents={systemData.residents.filter(r => r.roomId === selectedItem.id)}
                            onClose={() => {
                                setShowModal(null);
                                setSelectedItem(null);
                            }}
                        />
                    )}

                    {showModal === 'residentDetails' && selectedItem && (
                        <ResidentDetailsModal
                            resident={selectedItem}
                            room={systemData.rooms.find(r => r.id === selectedItem.roomId)}
                            onClose={() => {
                                setShowModal(null);
                                setSelectedItem(null);
                            }}
                            onMarkPaid={() => markPayment(selectedItem.id)}
                            onTerminate={() => terminateResident(selectedItem.id)}
                        />
                    )}

                    {showModal === 'expenseDetails' && selectedItem && (
                        <ExpenseDetailsModal
                            expense={selectedItem}
                            onClose={() => {
                                setShowModal(null);
                                setSelectedItem(null);
                            }}
                        />
                    )}

                    {showModal === 'userDetails' && selectedItem && (
                        <UserDetailsModal
                            user={selectedItem}
                            currentUser={currentUser}
                            onClose={() => {
                                setShowModal(null);
                                setSelectedItem(null);
                            }}
                            onDelete={() => deleteUser(selectedItem.id)}
                        />
                    )}
                </div>
            );
        }

        // Component implementations will continue in part 2...
        // (WelcomeScreen, OnboardingScreen, LoginScreen, Dashboard, etc.)

        // Welcome Screen
        function WelcomeScreen({ onGetStarted }) {
            return (
                <div className="welcome-screen">
                    <div className="welcome-content">
                        <div className="logo">
                            <div className="logo-icon"></div>
                            <h1>HostelHub</h1>
                            <p>Enhanced Management System</p>
                        </div>
                        <div style={{ textAlign: 'center', color: 'white', marginTop: '2rem', lineHeight: '2' }}>
                             Complete Hostel Management<br/>
                             Multi-User Access Control<br/>
                             Payment & Expense Tracking<br/>
                             Monthly Reports & Analytics<br/>
                             Excel Data Backup
                        </div>
                        <div className="welcome-buttons">
                            <button className="btn btn-white" onClick={onGetStarted}>
                                Get Started 
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

       // Onboarding Screen
        function OnboardingScreen({ onComplete, onBack }) {
            const [step, setStep] = useState(1);
            const [hostelData, setHostelData] = useState({
                name: '',
                location: '',
                address: '',
                totalRooms: '',
                hostelType: 'Boys'
            });
            const [ownerData, setOwnerData] = useState({
                name: '',
                mobile: '',
                email: '',
                username: '',
                password: '',
                role: 'Owner'
            });

            const handleNext = () => {
                if (!hostelData.name || !hostelData.location) {
                    alert('Please fill required fields');
                    return;
                }
                setStep(2);
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                if (!ownerData.name || !ownerData.mobile || !ownerData.username || !ownerData.password) {
                    alert('Please fill all required fields');
                    return;
                }
                if (ownerData.password.length < 6) {
                    alert('Password must be at least 6 characters');
                    return;
                }
                onComplete(hostelData, ownerData);
            };

            return (
                <div className="onboarding-screen">
                    <div className="onboarding-header">
                        <h2>Setup Your Hostel</h2>
                        <p>Complete setup in 2 easy steps</p>
                    </div>

                    <div style={{ padding: '0 1.5rem' }}>
                        <div className="step-indicator" style={{ marginTop: '1.5rem' }}>
                            <div className={`step-dot ${step >= 1 ? 'active' : ''}`}></div>
                            <div className={`step-dot ${step >= 2 ? 'active' : ''}`}></div>
                        </div>

                        {step === 1 && (
                            <div className="step-card">
                                <h3 style={{ marginBottom: '1.5rem' }}> Hostel Information</h3>

                                <div className="form-group">
                                    <label>Hostel Name *</label>
                                    <input
                                        type="text"
                                        required
                                        value={hostelData.name}
                                        onChange={e => setHostelData({ ...hostelData, name: e.target.value })}
                                        placeholder="e.g., Sunrise Boys Hostel"
                                    />
                                </div>

                                <div className="form-group">
                                    <label>Location *</label>
                                    <input
                                        type="text"
                                        required
                                        value={hostelData.location}
                                        onChange={e => setHostelData({ ...hostelData, location: e.target.value })}
                                        placeholder="e.g., Koramangala, Bangalore"
                                    />
                                </div>

                                <div className="form-group">
                                    <label>Address</label>
                                    <textarea
                                        value={hostelData.address}
                                        onChange={e => setHostelData({ ...hostelData, address: e.target.value })}
                                        placeholder="Complete address"
                                    />
                                </div>

                                <div className="form-group">
                                    <label>Hostel Type *</label>
                                    <select
                                        value={hostelData.hostelType}
                                        onChange={e => setHostelData({ ...hostelData, hostelType: e.target.value })}
                                    >
                                        <option>Boys</option>
                                        <option>Girls</option>
                                        <option>Co-ed</option>
                                        <option>Working Professionals</option>
                                    </select>
                                </div>

                                <button className="btn btn-primary" onClick={handleNext}>
                                    Next Step 
                                </button>
                            </div>
                        )}

                        {step === 2 && (
                            <div className="step-card">
                                <h3 style={{ marginBottom: '1.5rem' }}> Owner Details</h3>

                                <form onSubmit={handleSubmit}>
                                    <div className="form-group">
                                        <label>Full Name *</label>
                                        <input
                                            type="text"
                                            required
                                            value={ownerData.name}
                                            onChange={e => setOwnerData({ ...ownerData, name: e.target.value })}
                                            placeholder="Your name"
                                        />
                                    </div>

                                    <div className="form-group">
                                        <label>Mobile *</label>
                                        <input
                                            type="tel"
                                            required
                                            value={ownerData.mobile}
                                            onChange={e => setOwnerData({ ...ownerData, mobile: e.target.value })}
                                            placeholder="+91 98765 43210"
                                        />
                                    </div>

                                    <div className="form-group">
                                        <label>Email</label>
                                        <input
                                            type="email"
                                            value={ownerData.email}
                                            onChange={e => setOwnerData({ ...ownerData, email: e.target.value })}
                                            placeholder="your@email.com"
                                        />
                                    </div>

                                    <div className="form-group">
                                        <label>Username *</label>
                                        <input
                                            type="text"
                                            required
                                            value={ownerData.username}
                                            onChange={e => setOwnerData({ ...ownerData, username: e.target.value })}
                                            placeholder="Choose username"
                                        />
                                    </div>

                                    <div className="form-group">
                                        <label>Password *</label>
                                        <input
                                            type="password"
                                            required
                                            value={ownerData.password}
                                            onChange={e => setOwnerData({ ...ownerData, password: e.target.value })}
                                            placeholder="Min 6 characters"
                                        />
                                    </div>

                                    <div style={{ display: 'flex', gap: '1rem' }}>
                                        <button
                                            type="button"
                                            className="btn btn-secondary"
                                            onClick={() => setStep(1)}
                                            style={{ width: '40%' }}
                                        >
                                             Back
                                        </button>
                                        <button type="submit" className="btn btn-primary" style={{ width: '60%' }}>
                                            Complete 
                                        </button>
                                    </div>
                                </form>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        // Login Screen
        function LoginScreen({ hostelName, onLogin }) {
            const [username, setUsername] = useState('');
            const [password, setPassword] = useState('');

            const handleSubmit = (e) => {
                e.preventDefault();
                onLogin(username, password);
            };

            return (
                <div className="login-screen">
                    <div className="login-content">
                        <div className="logo">
                            <div className="logo-icon"></div>
                            <h1>HostelHub</h1>
                            {hostelName && <p>{hostelName}</p>}
                        </div>

                        <div className="login-form">
                            <h3 className="text-center mb-2">Login</h3>

                            <form onSubmit={handleSubmit}>
                                <div className="form-group">
                                    <label>Username</label>
                                    <input
                                        type="text"
                                        required
                                        value={username}
                                        onChange={e => setUsername(e.target.value)}
                                        placeholder="Enter username"
                                    />
                                </div>

                                <div className="form-group">
                                    <label>Password</label>
                                    <input
                                        type="password"
                                        required
                                        value={password}
                                        onChange={e => setPassword(e.target.value)}
                                        placeholder="Enter password"
                                    />
                                </div>

                                <button type="submit" className="btn btn-primary mt-1">
                                    Login 
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            );
        }

        // Dashboard Component
        function Dashboard({ hostel, user, stats, onMenuClick, onAction, onNavigate }) {
            return (
                <div className="dashboard">
                    <div className="header">
                        <div className="header-content">
                            <h2>{hostel.name}</h2>
                            <button className="menu-btn" onClick={onMenuClick}></button>
                        </div>
                    </div>

                    <div className="greeting">
                        <div className="greeting-content">
                            <h1>Welcome, {user.name}! </h1>
                            <p>{hostel.location}  {user.role}</p>
                        </div>
                    </div>

                    <div className="stats-grid">
                        <div className="stat-card" onClick={() => onNavigate('rooms')}>
                            <div className="stat-icon"></div>
                            <div className="stat-value">{stats.occupiedBeds}/{stats.totalBeds}</div>
                            <div className="stat-label">Beds Occupied</div>
                        </div>
                        <div className="stat-card" onClick={() => onNavigate('residents')}>
                            <div className="stat-icon"></div>
                            <div className="stat-value">{stats.occupiedBeds}</div>
                            <div className="stat-label">Total Residents</div>
                        </div>
                        <div className="stat-card" onClick={() => onNavigate('payments')}>
                            <div className="stat-icon"></div>
                            <div className="stat-value">{(stats.totalRevenue / 1000).toFixed(0)}k</div>
                            <div className="stat-label">Monthly Revenue</div>
                        </div>
                        <div className="stat-card" onClick={() => onNavigate('payments')}>
                            <div className="stat-icon"></div>
                            <div className="stat-value">{stats.pendingPayments}</div>
                            <div className="stat-label">Pending Payments</div>
                        </div>
                    </div>

                    <div className="quick-actions">
                        <h3 className="section-title">Quick Actions</h3>
                        <div className="action-grid">
                            <div className="action-card" onClick={() => onAction('addResident')}>
                                <div className="action-icon"></div>
                                <div className="action-label">Add Resident</div>
                            </div>
                            <div className="action-card" onClick={() => onAction('addRoom')}>
                                <div className="action-icon"></div>
                                <div className="action-label">Add Room</div>
                            </div>
                            <div className="action-card" onClick={() => onNavigate('expenses')}>
                                <div className="action-icon"></div>
                                <div className="action-label">Add Expense</div>
                            </div>
                            <div className="action-card" onClick={() => onNavigate('reports')}>
                                <div className="action-icon"></div>
                                <div className="action-label">View Reports</div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // Rooms Screen
        function RoomsScreen({ rooms, residents, onAdd, onRoomClick }) {
            const floors = [...new Set(rooms.map(r => r.floor))];

            return (
                <>
                    <div className="header">
                        <div className="header-content">
                            <h2>Rooms</h2>
                        </div>
                    </div>

                    {rooms.length === 0 ? (
                        <div className="empty-state">
                            <div className="empty-icon"></div>
                            <h3>No rooms yet</h3>
                            <p>Add your first room to get started</p>
                            <button className="btn btn-primary" onClick={onAdd}>+ Add Room</button>
                        </div>
                    ) : (
                        <div className="rooms-container">
                            {floors.map(floor => {
                                const floorRooms = rooms.filter(r => r.floor === floor);
                                const totalBeds = floorRooms.reduce((sum, r) => sum + r.totalBeds, 0);
                                const occupiedBeds = floorRooms.reduce(
                                    (sum, r) => sum + r.beds.filter(b => b.occupied).length,
                                    0
                                );

                                return (
                                    <div key={floor} className="floor-section">
                                        <div className="floor-header">
                                            <div className="floor-title">{floor}</div>
                                            <div className="floor-stats">{occupiedBeds}/{totalBeds} beds</div>
                                        </div>

                                        <div className="rooms-grid">
                                            {floorRooms.map(room => {
                                                const occupiedCount = room.beds.filter(b => b.occupied).length;
                                                const isFull = occupiedCount === room.totalBeds;
                                                const hasSpace = occupiedCount < room.totalBeds;

                                                return (
                                                    <div
                                                        key={room.id}
                                                        className={`room-card ${isFull ? 'full' : hasSpace ? 'available' : ''}`}
                                                        onClick={() => onRoomClick(room)}
                                                    >
                                                        <div className="room-number">Room {room.number}</div>
                                                        <div className="room-type">{room.type}</div>

                                                        <div className="beds-indicator">
                                                            {room.beds.map(bed => (
                                                                <div
                                                                    key={bed.bedNumber}
                                                                    className={`bed ${bed.occupied ? 'occupied' : 'available'}`}
                                                                >
                                                                    {bed.bedNumber}
                                                                </div>
                                                            ))}
                                                        </div>

                                                        <div className="room-rent">{room.rent}/bed</div>
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    </div>
                                );
                            })}
                        </div>
                    )}

                    <button className="fab" onClick={onAdd}>+</button>
                </>
            );
        }

        // Residents Screen
        function ResidentsScreen({ residents, rooms, onAdd, onResidentClick }) {
            return (
                <>
                    <div className="header">
                        <div className="header-content">
                            <h2>Residents</h2>
                        </div>
                    </div>

                    {residents.length === 0 ? (
                        <div className="empty-state">
                            <div className="empty-icon"></div>
                            <h3>No residents yet</h3>
                            <p>Add residents to track them</p>
                            <button className="btn btn-primary" onClick={onAdd}>+ Add Resident</button>
                        </div>
                    ) : (
                        <div className="residents-list">
                            {residents.map(resident => {
                                const room = rooms.find(r => r.id === resident.roomId);
                                const daysSinceJoining = Math.floor((new Date() - new Date(resident.joinDate)) / (1000 * 60 * 60 * 24));
                                
                                return (
                                    <div
                                        key={resident.id}
                                        className="resident-card"
                                        onClick={() => onResidentClick(resident)}
                                    >
                                        <div className="resident-avatar">
                                            {resident.name.charAt(0)}
                                        </div>
                                        <div className="resident-info">
                                            <div className="resident-name">{resident.name}</div>
                                            <div className="resident-room">
                                                Room {room?.number}  Bed {resident.bedNumber}
                                            </div>
                                            <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)', marginBottom: '0.5rem' }}>
                                                Joined: {new Date(resident.joinDate).toLocaleDateString('en-IN')} ({daysSinceJoining} days ago)
                                            </div>
                                            <div className={`resident-status status-${resident.paymentStatus}`}>
                                                {resident.paymentStatus === 'paid' && ' Paid'}
                                                {resident.paymentStatus === 'pending' && ' Pending'}
                                                {resident.paymentStatus === 'overdue' && ' Overdue'}
                                            </div>
                                        </div>
                                    </div>
                                );
                            })}
                        </div>
                    )}

                    <button className="fab" onClick={onAdd}>+</button>
                </>
            );
        }

        // Payments Screen
        function PaymentsScreen({ residents, rooms, onMarkPaid }) {
            const totalDue = residents.reduce((sum, r) => sum + r.rent + r.messCharges, 0);
            const collected = residents
                .filter(r => r.paymentStatus === 'paid')
                .reduce((sum, r) => sum + r.rent + r.messCharges, 0);
            const pending = totalDue - collected;

            // Check for payment reminders (residents with pending payments > 5 days)
            const overdueResidents = residents.filter(r => {
                if (r.paymentStatus !== 'paid' && r.lastPayment) {
                    const daysSincePayment = Math.floor((new Date() - new Date(r.lastPayment)) / (1000 * 60 * 60 * 24));
                    return daysSincePayment > 30;
                }
                return false;
            });

            return (
                <>
                    <div className="payment-summary">
                        <div className="payment-amount">{(collected / 1000).toFixed(0)}k</div>
                        <div style={{ opacity: 0.9, fontSize: '0.95rem' }}>Collected This Month</div>

                        <div className="payment-breakdown">
                            <div className="breakdown-item">
                                <div className="breakdown-value">{(totalDue / 1000).toFixed(0)}k</div>
                                <div className="breakdown-label">Total Due</div>
                            </div>
                            <div className="breakdown-item">
                                <div className="breakdown-value">{(pending / 1000).toFixed(0)}k</div>
                                <div className="breakdown-label">Pending</div>
                            </div>
                            <div className="breakdown-item">
                                <div className="breakdown-value">
                                    {residents.filter(r => r.paymentStatus === 'paid').length}
                                </div>
                                <div className="breakdown-label">Paid</div>
                            </div>
                        </div>

                        {overdueResidents.length > 0 && (
                            <div style={{ marginTop: '1rem', padding: '0.75rem', background: 'rgba(255,255,255,0.2)', borderRadius: '12px' }}>
                                <div style={{ fontSize: '0.85rem', fontWeight: '600' }}> Payment Reminders ({overdueResidents.length})</div>
                                <div style={{ fontSize: '0.75rem', opacity: 0.9, marginTop: '0.25rem' }}>
                                    {overdueResidents.map(r => r.name).join(', ')} - Overdue
                                </div>
                            </div>
                        )}
                    </div>

                    <div className="payment-list">
                        {residents.map(resident => {
                            const room = rooms.find(r => r.id === resident.roomId);
                            const total = resident.rent + resident.messCharges;

                            return (
                                <div key={resident.id} className="payment-card">
                                    <div className="payment-header">
                                        <div>
                                            <div className="payment-resident">{resident.name}</div>
                                            <div className="payment-room">Room {room?.number}  Bed {resident.bedNumber}</div>
                                        </div>
                                        <div className="payment-amount-card">{total.toLocaleString()}</div>
                                    </div>

                                    <div className="payment-details">
                                        <div className="detail-item">
                                            <div className="detail-label">Room Rent</div>
                                            <div className="detail-value">{resident.rent.toLocaleString()}</div>
                                        </div>
                                        <div className="detail-item">
                                            <div className="detail-label">Mess</div>
                                            <div className="detail-value">{resident.messCharges.toLocaleString()}</div>
                                        </div>
                                        <div className="detail-item">
                                            <div className="detail-label">Status</div>
                                            <div className={`resident-status status-${resident.paymentStatus}`}>
                                                {resident.paymentStatus === 'paid' && ' Paid'}
                                                {resident.paymentStatus === 'pending' && ' Pending'}
                                                {resident.paymentStatus === 'overdue' && ' Overdue'}
                                            </div>
                                        </div>
                                        <div className="detail-item">
                                            {resident.paymentStatus !== 'paid' ? (
                                                <button
                                                    className="btn btn-success btn-sm"
                                                    onClick={() => onMarkPaid(resident.id)}
                                                >
                                                    Mark Paid
                                                </button>
                                            ) : (
                                                <div>
                                                    <div className="detail-label">Paid On</div>
                                                    <div className="detail-value">
                                                        {new Date(resident.lastPayment).toLocaleDateString('en-IN')}
                                                    </div>
                                                </div>
                                            )}
                                        </div>
                                    </div>
                                </div>
                            );
                        })}
                    </div>
                </>
            );
        }

        // Expenses Screen
        function ExpensesScreen({ expenses, onAdd, onExpenseClick }) {
            const totalExpenses = expenses.reduce((sum, e) => sum + e.amount, 0);
            const currentMonth = new Date().getMonth();
            const currentMonthExpenses = expenses.filter(e => new Date(e.date).getMonth() === currentMonth);
            const currentMonthTotal = currentMonthExpenses.reduce((sum, e) => sum + e.amount, 0);

            // Group by category
            const byCategory = expenses.reduce((acc, expense) => {
                acc[expense.category] = (acc[expense.category] || 0) + expense.amount;
                return acc;
            }, {});

            return (
                <>
                    <div className="header">
                        <div className="header-content">
                            <h2>Expenses</h2>
                        </div>
                    </div>

                    <div style={{ padding: '1.5rem', background: 'linear-gradient(135deg, var(--danger) 0%, #DC2626 100%)', color: 'white' }}>
                        <div style={{ fontSize: '2.5rem', fontWeight: '900', marginBottom: '0.5rem' }}>
                            {(currentMonthTotal / 1000).toFixed(0)}k
                        </div>
                        <div style={{ opacity: 0.9, fontSize: '0.95rem' }}>This Month's Expenses</div>

                        <div className="payment-breakdown">
                            <div className="breakdown-item">
                                <div className="breakdown-value">{(totalExpenses / 1000).toFixed(0)}k</div>
                                <div className="breakdown-label">Total All Time</div>
                            </div>
                            <div className="breakdown-item">
                                <div className="breakdown-value">{currentMonthExpenses.length}</div>
                                <div className="breakdown-label">This Month</div>
                            </div>
                            <div className="breakdown-item">
                                <div className="breakdown-value">{Object.keys(byCategory).length}</div>
                                <div className="breakdown-label">Categories</div>
                            </div>
                        </div>
                    </div>

                    {expenses.length === 0 ? (
                        <div className="empty-state">
                            <div className="empty-icon"></div>
                            <h3>No expenses yet</h3>
                            <p>Track your hostel expenses</p>
                            <button className="btn btn-primary" onClick={onAdd}>+ Add Expense</button>
                        </div>
                    ) : (
                        <div className="expenses-list">
                            {expenses.sort((a, b) => new Date(b.date) - new Date(a.date)).map(expense => (
                                <div
                                    key={expense.id}
                                    className="expense-card"
                                    onClick={() => onExpenseClick(expense)}
                                >
                                    <div className="expense-icon-circle" style={{ background: 'linear-gradient(135deg, var(--danger) 0%, #DC2626 100%)' }}>
                                        {expense.category === 'Mess Ration' && ''}
                                        {expense.category === 'Maintenance' && ''}
                                        {expense.category === 'Electricity Bill' && ''}
                                        {expense.category === 'Water Bill' && ''}
                                        {expense.category === 'Internet Bill' && ''}
                                        {expense.category === 'Salary' && ''}
                                        {expense.category === 'Other' && ''}
                                    </div>
                                    <div className="expense-info">
                                        <div className="expense-title">{expense.amount.toLocaleString()}</div>
                                        <div className="expense-category">{expense.category}</div>
                                        <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)', marginTop: '0.25rem' }}>
                                            {new Date(expense.date).toLocaleDateString('en-IN')}
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    )}

                    <button className="fab" onClick={onAdd}>+</button>
                </>
            );
        }

        // Reports Screen
        function ReportsScreen({ systemData, stats }) {
            const currentMonth = new Date().getMonth();
            const currentYear = new Date().getFullYear();
            
            // Calculate monthly metrics
            const monthlyResidents = systemData.residents.filter(r => {
                const joinMonth = new Date(r.joinDate).getMonth();
                const joinYear = new Date(r.joinDate).getFullYear();
                return joinMonth === currentMonth && joinYear === currentYear;
            });

            const monthlyExpenses = (systemData.expenses || []).filter(e => {
                const expMonth = new Date(e.date).getMonth();
                const expYear = new Date(e.date).getFullYear();
                return expMonth === currentMonth && expYear === currentYear;
            });

            const totalMonthlyExpenses = monthlyExpenses.reduce((sum, e) => sum + e.amount, 0);
            const netProfit = stats.totalRevenue - totalMonthlyExpenses;
            const occupancyRate = stats.totalBeds > 0 ? ((stats.occupiedBeds / stats.totalBeds) * 100).toFixed(1) : 0;

            return (
                <>
                    <div className="header">
                        <div className="header-content">
                            <h2>Reports</h2>
                        </div>
                    </div>

                    <div className="reports-container">
                        <div className="report-card">
                            <div className="report-header">
                                <div className="report-title"> Monthly Summary</div>
                                <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)' }}>
                                    {new Date().toLocaleDateString('en-IN', { month: 'long', year: 'numeric' })}
                                </div>
                            </div>

                            <div className="report-stats">
                                <div className="report-stat">
                                    <div className="report-stat-label">Occupancy Rate</div>
                                    <div className="report-stat-value" style={{ color: 'var(--primary)' }}>{occupancyRate}%</div>
                                </div>
                                <div className="report-stat">
                                    <div className="report-stat-label">Total Residents</div>
                                    <div className="report-stat-value">{stats.occupiedBeds}</div>
                                </div>
                                <div className="report-stat">
                                    <div className="report-stat-label">New Admissions</div>
                                    <div className="report-stat-value" style={{ color: 'var(--success)' }}>{monthlyResidents.length}</div>
                                </div>
                                <div className="report-stat">
                                    <div className="report-stat-label">Pending Payments</div>
                                    <div className="report-stat-value" style={{ color: 'var(--warning)' }}>{stats.pendingPayments}</div>
                                </div>
                            </div>
                        </div>

                        <div className="report-card">
                            <div className="report-header">
                                <div className="report-title"> Financial Summary</div>
                            </div>

                            <div className="report-stats">
                                <div className="report-stat">
                                    <div className="report-stat-label">Total Revenue</div>
                                    <div className="report-stat-value" style={{ color: 'var(--success)' }}>
                                        {(stats.totalRevenue / 1000).toFixed(0)}k
                                    </div>
                                </div>
                                <div className="report-stat">
                                    <div className="report-stat-label">Total Expenses</div>
                                    <div className="report-stat-value" style={{ color: 'var(--danger)' }}>
                                        {(totalMonthlyExpenses / 1000).toFixed(0)}k
                                    </div>
                                </div>
                                <div className="report-stat">
                                    <div className="report-stat-label">Net Profit</div>
                                    <div className="report-stat-value" style={{ color: netProfit >= 0 ? 'var(--success)' : 'var(--danger)' }}>
                                        {(netProfit / 1000).toFixed(0)}k
                                    </div>
                                </div>
                                <div className="report-stat">
                                    <div className="report-stat-label">Profit Margin</div>
                                    <div className="report-stat-value">
                                        {stats.totalRevenue > 0 ? ((netProfit / stats.totalRevenue) * 100).toFixed(1) : 0}%
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div className="report-card">
                            <div className="report-header">
                                <div className="report-title"> Expense Breakdown</div>
                            </div>

                            {monthlyExpenses.length === 0 ? (
                                <p style={{ textAlign: 'center', color: 'var(--text-muted)', padding: '2rem' }}>
                                    No expenses this month
                                </p>
                            ) : (
                                <div style={{ marginTop: '1rem' }}>
                                    {Object.entries(
                                        monthlyExpenses.reduce((acc, e) => {
                                            acc[e.category] = (acc[e.category] || 0) + e.amount;
                                            return acc;
                                        }, {})
                                    ).map(([category, amount]) => (
                                        <div key={category} style={{ display: 'flex', justifyContent: 'space-between', padding: '0.75rem', background: 'var(--bg)', borderRadius: '8px', marginBottom: '0.5rem' }}>
                                            <div style={{ fontWeight: '600' }}>{category}</div>
                                            <div style={{ color: 'var(--danger)', fontWeight: '700' }}>{amount.toLocaleString()}</div>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>

                        <div className="report-card">
                            <div className="report-header">
                                <div className="report-title"> Room Utilization</div>
                            </div>

                            <div style={{ marginTop: '1rem' }}>
                                {systemData.rooms.map(room => {
                                    const occupiedBeds = room.beds.filter(b => b.occupied).length;
                                    const utilization = (occupiedBeds / room.totalBeds) * 100;

                                    return (
                                        <div key={room.id} style={{ marginBottom: '1rem' }}>
                                            <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '0.5rem' }}>
                                                <div style={{ fontWeight: '600' }}>Room {room.number}</div>
                                                <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)' }}>
                                                    {occupiedBeds}/{room.totalBeds} beds ({utilization.toFixed(0)}%)
                                                </div>
                                            </div>
                                            <div style={{ height: '8px', background: 'var(--bg)', borderRadius: '4px', overflow: 'hidden' }}>
                                                <div style={{ 
                                                    width: `${utilization}%`, 
                                                    height: '100%', 
                                                    background: utilization === 100 ? 'var(--danger)' : utilization > 50 ? 'var(--warning)' : 'var(--success)',
                                                    borderRadius: '4px',
                                                    transition: 'width 0.3s'
                                                }}></div>
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                        </div>
                    </div>
                </>
            );
        }

        // Users Screen
        function UsersScreen({ users, currentUser, onAdd, onUserClick }) {
            return (
                <>
                    <div className="header">
                        <div className="header-content">
                            <h2>Users & Staff</h2>
                        </div>
                    </div>

                    <div className="users-list">
                        {users.map(user => (
                            <div key={user.id} className="user-card" onClick={() => onUserClick(user)}>
                                <div className="user-avatar">{user.name.charAt(0)}</div>
                                <div className="user-info">
                                    <div className="user-name">
                                        {user.name}
                                        {user.id === currentUser.id && <span style={{ fontSize: '0.8rem', color: 'var(--text-muted)' }}> (You)</span>}
                                    </div>
                                    <div className="user-role">{user.mobile}</div>
                                </div>
                                <div className={`role-badge role-${user.role.toLowerCase()}`}>
                                    {user.role}
                                </div>
                            </div>
                        ))}
                    </div>

                    {currentUser.role === 'Owner' && (
                        <button className="fab" onClick={onAdd}>+</button>
                    )}
                </>
            );
        }

        // Bottom Navigation
        function BottomNav({ current, onChange, pendingCount }) {
            return (
                <div className="bottom-nav">
                    <button
                        className={`nav-item ${current === 'dashboard' ? 'active' : ''}`}
                        onClick={() => onChange('dashboard')}
                    >
                        <div className="icon"></div>
                        <span>Home</span>
                    </button>
                    <button
                        className={`nav-item ${current === 'rooms' ? 'active' : ''}`}
                        onClick={() => onChange('rooms')}
                    >
                        <div className="icon"></div>
                        <span>Rooms</span>
                    </button>
                    <button
                        className={`nav-item ${current === 'residents' ? 'active' : ''}`}
                        onClick={() => onChange('residents')}
                    >
                        <div className="icon"></div>
                        <span>Residents</span>
                    </button>
                    <button
                        className={`nav-item ${current === 'payments' ? 'active' : ''}`}
                        onClick={() => onChange('payments')}
                    >
                        <div className="icon" style={{ position: 'relative' }}>
                            
                            {pendingCount > 0 && <span className="notification-badge">{pendingCount}</span>}
                        </div>
                        <span>Payments</span>
                    </button>
                </div>
            );
        }

        // Settings Menu
        function SettingsMenu({ user, hostel, onClose, onLogout, onBackup, onChangePassword, onNavigate }) {
            return (
                <>
                    <div className="settings-overlay" onClick={onClose}></div>
                    <div className="settings-menu">
                        <div className="settings-header">
                            <h3>Settings</h3>
                            <p>{user.role}  {hostel.name}</p>
                        </div>

                        <div className="settings-section">
                            <h4>Account</h4>
                            <div className="settings-item">
                                <div className="settings-icon"></div>
                                <div className="settings-text">
                                    <h5>{user.name}</h5>
                                    <p>{user.mobile}</p>
                                </div>
                            </div>
                            <div className="settings-item" onClick={onChangePassword}>
                                <div className="settings-icon"></div>
                                <div className="settings-text">
                                    <h5>Change Password</h5>
                                    <p>Update your password</p>
                                </div>
                            </div>
                        </div>

                        <div className="settings-section">
                            <h4>Manage</h4>
                            {user.role === 'Owner' && (
                                <div className="settings-item" onClick={() => onNavigate('users')}>
                                    <div className="settings-icon"></div>
                                    <div className="settings-text">
                                        <h5>Users & Staff</h5>
                                        <p>Manage access</p>
                                    </div>
                                </div>
                            )}
                            <div className="settings-item" onClick={() => onNavigate('expenses')}>
                                <div className="settings-icon"></div>
                                <div className="settings-text">
                                    <h5>Expenses</h5>
                                    <p>Track expenses</p>
                                </div>
                            </div>
                            <div className="settings-item" onClick={() => onNavigate('reports')}>
                                <div className="settings-icon"></div>
                                <div className="settings-text">
                                    <h5>Reports</h5>
                                    <p>View analytics</p>
                                </div>
                            </div>
                        </div>

                        <div className="settings-section">
                            <h4>Data</h4>
                            <div className="settings-item" onClick={onBackup}>
                                <div className="settings-icon"></div>
                                <div className="settings-text">
                                    <h5>Backup to Excel</h5>
                                    <p>Export all data</p>
                                </div>
                            </div>
                        </div>

                        <button className="btn btn-primary" onClick={onLogout} style={{ margin: '1.5rem' }}>
                            Logout
                        </button>
                    </div>
                </>
            );
        }

      // User Modal
        function UserModal({ onClose, onSave }) {
            const [formData, setFormData] = useState({
                name: '',
                mobile: '',
                email: '',
                username: '',
                password: '',
                role: 'Manager'
            });

            const handleSubmit = (e) => {
                e.preventDefault();
                if (formData.password.length < 6) {
                    alert('Password must be at least 6 characters');
                    return;
                }
                onSave(formData);
            };

            return (
                <div className="modal-overlay" onClick={onClose}>
                    <div className="modal" onClick={e => e.stopPropagation()}>
                        <div className="modal-header">
                            <h3>Add New User</h3>
                            <button className="close-btn" onClick={onClose}></button>
                        </div>
                        <div className="modal-body">
                            <form onSubmit={handleSubmit}>
                                <div className="form-group">
                                    <label>Name *</label>
                                    <input
                                        type="text"
                                        required
                                        value={formData.name}
                                        onChange={e => setFormData({ ...formData, name: e.target.value })}
                                        placeholder="Full name"
                                    />
                                </div>

                                <div className="form-group">
                                    <label>Mobile *</label>
                                    <input
                                        type="tel"
                                        required
                                        value={formData.mobile}
                                        onChange={e => setFormData({ ...formData, mobile: e.target.value })}
                                        placeholder="+91 98765 43210"
                                    />
                                </div>

                                <div className="form-group">
                                    <label>Email</label>
                                    <input
                                        type="email"
                                        value={formData.email}
                                        onChange={e => setFormData({ ...formData, email: e.target.value })}
                                        placeholder="email@example.com"
                                    />
                                </div>

                                <div className="form-group">
                                    <label>Role *</label>
                                    <select
                                        value={formData.role}
                                        onChange={e => setFormData({ ...formData, role: e.target.value })}
                                    >
                                        <option>Manager</option>
                                        <option>Staff</option>
                                        <option>Accountant</option>
                                    </select>
                                </div>

                                <div className="form-group">
                                    <label>Username *</label>
                                    <input
                                        type="text"
                                        required
                                        value={formData.username}
                                        onChange={e => setFormData({ ...formData, username: e.target.value })}
                                        placeholder="Choose username"
                                    />
                                    <div className="form-hint">This will be used to log in</div>
                                </div>

                                <div className="form-group">
                                    <label>Password *</label>
                                    <input
                                        type="password"
                                        required
                                        value={formData.password}
                                        onChange={e => setFormData({ ...formData, password: e.target.value })}
                                        placeholder="Min 6 characters"
                                    />
                                    <div className="form-hint">User can change this later</div>
                                </div>

                                <button type="submit" className="btn btn-primary mt-1">
                                    Add User
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            );
        }

        // Room Modal
        function RoomModal({ onClose, onSave }) {
            const [formData, setFormData] = useState({
                number: '',
                floor: 'Ground Floor',
                type: 'Triple Sharing',
                totalBeds: 3,
                rent: ''
            });

            const handleSubmit = (e) => {
                e.preventDefault();
                onSave({
                    ...formData,
                    totalBeds: parseInt(formData.totalBeds),
                    rent: parseInt(formData.rent)
                });
            };

            return (
                <div className="modal-overlay" onClick={onClose}>
                    <div className="modal" onClick={e => e.stopPropagation()}>
                        <div className="modal-header">
                            <h3>Add Room</h3>
                            <button className="close-btn" onClick={onClose}></button>
                        </div>
                        <div className="modal-body">
                            <form onSubmit={handleSubmit}>
                                <div className="form-group">
                                    <label>Room Number *</label>
                                    <input
                                        type="text"
                                        required
                                        value={formData.number}
                                        onChange={e => setFormData({ ...formData, number: e.target.value })}
                                        placeholder="e.g., 101"
                                    />
                                </div>

                                <div className="form-group">
                                    <label>Floor *</label>
                                    <select
                                        value={formData.floor}
                                        onChange={e => setFormData({ ...formData, floor: e.target.value })}
                                    >
                                        <option>Ground Floor</option>
                                        <option>First Floor</option>
                                        <option>Second Floor</option>
                                        <option>Third Floor</option>
                                    </select>
                                </div>

                                <div className="form-group">
                                    <label>Room Type *</label>
                                    <select
                                        value={formData.type}
                                        onChange={e => {
                                            const beds = e.target.value.includes('Single') ? 1 :
                                                        e.target.value.includes('Double') ? 2 : 3;
                                            setFormData({ ...formData, type: e.target.value, totalBeds: beds });
                                        }}
                                    >
                                        <option>Single Sharing</option>
                                        <option>Double Sharing</option>
                                        <option>Triple Sharing</option>
                                    </select>
                                </div>

                                <div className="form-group">
                                    <label>Total Beds *</label>
                                    <input
                                        type="number"
                                        required
                                        min="1"
                                        max="6"
                                        value={formData.totalBeds}
                                        onChange={e => setFormData({ ...formData, totalBeds: e.target.value })}
                                    />
                                </div>

                                <div className="form-group">
                                    <label>Rent per Bed () *</label>
                                    <input
                                        type="number"
                                        required
                                        value={formData.rent}
                                        onChange={e => setFormData({ ...formData, rent: e.target.value })}
                                        placeholder="5000"
                                    />
                                </div>

                                <button type="submit" className="btn btn-primary mt-1">
                                    Add Room
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            );
        }

        // Resident Modal
        function ResidentModal({ rooms, onClose, onSave }) {
            const [formData, setFormData] = useState({
                name: '',
                phone: '',
                email: '',
                guardianName: '',
                guardianPhone: '',
                joinDate: new Date().toISOString().split('T')[0],
                rent: '',
                messCharges: 3000
            });
            const [selectedRoom, setSelectedRoom] = useState(null);
            const [selectedBed, setSelectedBed] = useState(null);

            const availableRooms = rooms.filter(r => r.beds.some(b => !b.occupied));

            const handleSubmit = (e) => {
                e.preventDefault();
                if (!selectedRoom || !selectedBed) {
                    alert('Please select room and bed');
                    return;
                }
                onSave(
                    {
                        ...formData,
                        rent: parseInt(formData.rent),
                        messCharges: parseInt(formData.messCharges)
                    },
                    selectedRoom.id,
                    selectedBed
                );
            };

            return (
                <div className="modal-overlay" onClick={onClose}>
                    <div className="modal" onClick={e => e.stopPropagation()}>
                        <div className="modal-header">
                            <h3>Add Resident</h3>
                            <button className="close-btn" onClick={onClose}></button>
                        </div>
                        <div className="modal-body">
                            <form onSubmit={handleSubmit}>
                                <div className="form-group">
                                    <label>Full Name *</label>
                                    <input
                                        type="text"
                                        required
                                        value={formData.name}
                                        onChange={e => setFormData({ ...formData, name: e.target.value })}
                                        placeholder="Resident name"
                                    />
                                </div>

                                <div className="form-group">
                                    <label>Phone *</label>
                                    <input
                                        type="tel"
                                        required
                                        value={formData.phone}
                                        onChange={e => setFormData({ ...formData, phone: e.target.value })}
                                        placeholder="+91 98765 43210"
                                    />
                                </div>

                                <div className="form-group">
                                    <label>Join Date *</label>
                                    <input
                                        type="date"
                                        required
                                        value={formData.joinDate}
                                        onChange={e => setFormData({ ...formData, joinDate: e.target.value })}
                                    />
                                    <div className="form-hint">Date when resident moved in</div>
                                </div>

                                <div className="form-group">
                                    <label>Guardian Name *</label>
                                    <input
                                        type="text"
                                        required
                                        value={formData.guardianName}
                                        onChange={e => setFormData({ ...formData, guardianName: e.target.value })}
                                        placeholder="Parent/Guardian name"
                                    />
                                </div>

                                <div className="form-group">
                                    <label>Guardian Phone *</label>
                                    <input
                                        type="tel"
                                        required
                                        value={formData.guardianPhone}
                                        onChange={e => setFormData({ ...formData, guardianPhone: e.target.value })}
                                        placeholder="+91 98765 99999"
                                    />
                                </div>

                                <div className="form-group">
                                    <label>Select Room *</label>
                                    <select
                                        value={selectedRoom?.id || ''}
                                        onChange={e => {
                                            const room = rooms.find(r => r.id === parseInt(e.target.value));
                                            setSelectedRoom(room);
                                            setSelectedBed(null);
                                            setFormData({ ...formData, rent: room?.rent || '' });
                                        }}
                                    >
                                        <option value="">Choose room</option>
                                        {availableRooms.map(room => (
                                            <option key={room.id} value={room.id}>
                                                Room {room.number} - {room.type}
                                            </option>
                                        ))}
                                    </select>
                                </div>

                                {selectedRoom && (
                                    <div className="form-group">
                                        <label>Select Bed *</label>
                                        <div className="bed-grid">
                                            {selectedRoom.beds.map(bed => (
                                                <div
                                                    key={bed.bedNumber}
                                                    className={`bed-selector ${bed.occupied ? 'occupied' : ''} ${selectedBed === bed.bedNumber ? 'selected' : ''}`}
                                                    onClick={() => !bed.occupied && setSelectedBed(bed.bedNumber)}
                                                >
                                                    <div className="bed-number">Bed {bed.bedNumber}</div>
                                                    <div className="bed-status-text">
                                                        {bed.occupied ? 'Occupied' : 'Available'}
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}

                                <div className="form-group">
                                    <label>Room Rent () *</label>
                                    <input
                                        type="number"
                                        required
                                        value={formData.rent}
                                        onChange={e => setFormData({ ...formData, rent: e.target.value })}
                                        placeholder="5000"
                                    />
                                </div>

                                <div className="form-group">
                                    <label>Mess Charges () *</label>
                                    <input
                                        type="number"
                                        required
                                        value={formData.messCharges}
                                        onChange={e => setFormData({ ...formData, messCharges: e.target.value })}
                                        placeholder="3000"
                                    />
                                </div>

                                <button type="submit" className="btn btn-primary mt-1">
                                    Add Resident
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            );
        }

        // Expense Modal
        function ExpenseModal({ onClose, onSave }) {
            const [formData, setFormData] = useState({
                category: 'Mess Ration',
                amount: '',
                date: new Date().toISOString().split('T')[0],
                description: ''
            });

            const handleSubmit = (e) => {
                e.preventDefault();
                onSave({
                    ...formData,
                    amount: parseInt(formData.amount)
                });
            };

            return (
                <div className="modal-overlay" onClick={onClose}>
                    <div className="modal" onClick={e => e.stopPropagation()}>
                        <div className="modal-header">
                            <h3>Add Expense</h3>
                            <button className="close-btn" onClick={onClose}></button>
                        </div>
                        <div className="modal-body">
                            <form onSubmit={handleSubmit}>
                                <div className="form-group">
                                    <label>Category *</label>
                                    <select
                                        value={formData.category}
                                        onChange={e => setFormData({ ...formData, category: e.target.value })}
                                    >
                                        <option>Mess Ration</option>
                                        <option>Maintenance</option>
                                        <option>Electricity Bill</option>
                                        <option>Water Bill</option>
                                        <option>Internet Bill</option>
                                        <option>Salary</option>
                                        <option>Other</option>
                                    </select>
                                </div>

                                <div className="form-group">
                                    <label>Amount () *</label>
                                    <input
                                        type="number"
                                        required
                                        value={formData.amount}
                                        onChange={e => setFormData({ ...formData, amount: e.target.value })}
                                        placeholder="5000"
                                    />
                                </div>

                                <div className="form-group">
                                    <label>Date *</label>
                                    <input
                                        type="date"
                                        required
                                        value={formData.date}
                                        onChange={e => setFormData({ ...formData, date: e.target.value })}
                                    />
                                </div>

                                <div className="form-group">
                                    <label>Description</label>
                                    <textarea
                                        value={formData.description}
                                        onChange={e => setFormData({ ...formData, description: e.target.value })}
                                        placeholder="Optional notes about this expense"
                                    />
                                </div>

                                <button type="submit" className="btn btn-primary mt-1">
                                    Add Expense
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            );
        }

        // Change Password Modal
        function ChangePasswordModal({ onClose, onSave }) {
            const [formData, setFormData] = useState({
                currentPassword: '',
                newPassword: '',
                confirmPassword: ''
            });

            const handleSubmit = (e) => {
                e.preventDefault();
                
                if (formData.newPassword.length < 6) {
                    alert('New password must be at least 6 characters');
                    return;
                }

                if (formData.newPassword !== formData.confirmPassword) {
                    alert('New passwords do not match');
                    return;
                }

                const success = onSave(formData.currentPassword, formData.newPassword);
                if (success !== false) {
                    onClose();
                }
            };

            return (
                <div className="modal-overlay" onClick={onClose}>
                    <div className="modal" onClick={e => e.stopPropagation()}>
                        <div className="modal-header">
                            <h3>Change Password</h3>
                            <button className="close-btn" onClick={onClose}></button>
                        </div>
                        <div className="modal-body">
                            <form onSubmit={handleSubmit}>
                                <div className="form-group">
                                    <label>Current Password *</label>
                                    <input
                                        type="password"
                                        required
                                        value={formData.currentPassword}
                                        onChange={e => setFormData({ ...formData, currentPassword: e.target.value })}
                                        placeholder="Enter current password"
                                    />
                                </div>

                                <div className="form-group">
                                    <label>New Password *</label>
                                    <input
                                        type="password"
                                        required
                                        value={formData.newPassword}
                                        onChange={e => setFormData({ ...formData, newPassword: e.target.value })}
                                        placeholder="Min 6 characters"
                                    />
                                </div>

                                <div className="form-group">
                                    <label>Confirm New Password *</label>
                                    <input
                                        type="password"
                                        required
                                        value={formData.confirmPassword}
                                        onChange={e => setFormData({ ...formData, confirmPassword: e.target.value })}
                                        placeholder="Re-enter new password"
                                    />
                                </div>

                                <button type="submit" className="btn btn-primary mt-1">
                                    Change Password
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            );
        }

        // Room Details Modal
        function RoomDetailsModal({ room, residents, onClose }) {
            return (
                <div className="modal-overlay" onClick={onClose}>
                    <div className="modal" onClick={e => e.stopPropagation()}>
                        <div className="modal-header">
                            <h3>Room {room.number}</h3>
                            <button className="close-btn" onClick={onClose}></button>
                        </div>
                        <div className="modal-body">
                            <div className="form-group">
                                <label>Type</label>
                                <div style={{ fontSize: '1.1rem', fontWeight: '600' }}>{room.type}</div>
                            </div>

                            <div className="form-group">
                                <label>Floor</label>
                                <div style={{ fontSize: '1.1rem', fontWeight: '600' }}>{room.floor}</div>
                            </div>

                            <div className="form-group">
                                <label>Rent per Bed</label>
                                <div style={{ fontSize: '1.1rem', fontWeight: '600' }}>{room.rent.toLocaleString()}</div>
                            </div>

                            <div className="form-group">
                                <label>Bed Occupancy</label>
                                <div className="beds-indicator" style={{ marginTop: '0.5rem' }}>
                                    {room.beds.map(bed => (
                                        <div key={bed.bedNumber} className={`bed ${bed.occupied ? 'occupied' : 'available'}`}>
                                            {bed.bedNumber}
                                        </div>
                                    ))}
                                </div>
                            </div>

                            {residents.length > 0 && (
                                <div className="form-group">
                                    <label>Current Residents</label>
                                    {residents.map(r => (
                                        <div key={r.id} style={{ padding: '0.75rem', background: 'var(--bg)', borderRadius: '8px', marginBottom: '0.5rem' }}>
                                            <div style={{ fontWeight: '600' }}>{r.name}</div>
                                            <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)' }}>
                                                Bed {r.bedNumber}  {r.phone}
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        // Resident Details Modal
        function ResidentDetailsModal({ resident, room, onClose, onMarkPaid, onTerminate }) {
            const daysSinceJoining = Math.floor((new Date() - new Date(resident.joinDate)) / (1000 * 60 * 60 * 24));

            return (
                <div className="modal-overlay" onClick={onClose}>
                    <div className="modal" onClick={e => e.stopPropagation()}>
                        <div className="modal-header">
                            <h3>{resident.name}</h3>
                            <button className="close-btn" onClick={onClose}></button>
                        </div>
                        <div className="modal-body">
                            <div className="form-group">
                                <label>Room & Bed</label>
                                <div style={{ fontSize: '1.1rem', fontWeight: '600' }}>
                                    Room {room?.number}  Bed {resident.bedNumber}
                                </div>
                            </div>

                            <div className="form-group">
                                <label>Phone</label>
                                <div style={{ fontSize: '1.1rem', fontWeight: '600' }}>{resident.phone}</div>
                            </div>

                            <div className="form-group">
                                <label>Join Date</label>
                                <div style={{ fontSize: '1rem', fontWeight: '600' }}>
                                    {new Date(resident.joinDate).toLocaleDateString('en-IN')}
                                </div>
                                <div className="form-hint">Living here for {daysSinceJoining} days</div>
                            </div>

                            <div className="form-group">
                                <label>Guardian</label>
                                <div style={{ fontSize: '1rem', fontWeight: '600' }}>{resident.guardianName}</div>
                                <div style={{ fontSize: '0.9rem', color: 'var(--text-muted)' }}>{resident.guardianPhone}</div>
                            </div>

                            <div className="form-group">
                                <label>Monthly Charges</label>
                                <div style={{ fontSize: '1rem' }}>
                                    Rent: {resident.rent.toLocaleString()}<br/>
                                    Mess: {resident.messCharges.toLocaleString()}<br/>
                                    <strong>Total: {(resident.rent + resident.messCharges).toLocaleString()}</strong>
                                </div>
                            </div>

                            <div className="form-group">
                                <label>Payment Status</label>
                                <div className={`resident-status status-${resident.paymentStatus}`} style={{ display: 'inline-block' }}>
                                    {resident.paymentStatus === 'paid' && ' Paid'}
                                    {resident.paymentStatus === 'pending' && ' Pending'}
                                    {resident.paymentStatus === 'overdue' && ' Overdue'}
                                </div>
                            </div>

                            <div style={{ display: 'flex', gap: '1rem', marginTop: '1.5rem' }}>
                                {resident.paymentStatus !== 'paid' && (
                                    <button className="btn btn-success" onClick={onMarkPaid} style={{ flex: 1 }}>
                                        Mark Paid
                                    </button>
                                )}
                                <button className="btn btn-danger" onClick={onTerminate} style={{ flex: 1 }}>
                                    Terminate
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // Expense Details Modal
        function ExpenseDetailsModal({ expense, onClose }) {
            return (
                <div className="modal-overlay" onClick={onClose}>
                    <div className="modal" onClick={e => e.stopPropagation()}>
                        <div className="modal-header">
                            <h3>Expense Details</h3>
                            <button className="close-btn" onClick={onClose}></button>
                        </div>
                        <div className="modal-body">
                            <div className="form-group">
                                <label>Category</label>
                                <div style={{ fontSize: '1.1rem', fontWeight: '600' }}>{expense.category}</div>
                            </div>

                            <div className="form-group">
                                <label>Amount</label>
                                <div style={{ fontSize: '1.5rem', fontWeight: '700', color: 'var(--danger)' }}>
                                    {expense.amount.toLocaleString()}
                                </div>
                            </div>

                            <div className="form-group">
                                <label>Date</label>
                                <div style={{ fontSize: '1rem', fontWeight: '600' }}>
                                    {new Date(expense.date).toLocaleDateString('en-IN')}
                                </div>
                            </div>

                            {expense.description && (
                                <div className="form-group">
                                    <label>Description</label>
                                    <div style={{ fontSize: '1rem' }}>{expense.description}</div>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        // User Details Modal
        function UserDetailsModal({ user, currentUser, onClose, onDelete }) {
            return (
                <div className="modal-overlay" onClick={onClose}>
                    <div className="modal" onClick={e => e.stopPropagation()}>
                        <div className="modal-header">
                            <h3>User Details</h3>
                            <button className="close-btn" onClick={onClose}></button>
                        </div>
                        <div className="modal-body">
                            <div className="form-group">
                                <label>Name</label>
                                <div style={{ fontSize: '1.1rem', fontWeight: '600' }}>{user.name}</div>
                            </div>

                            <div className="form-group">
                                <label>Role</label>
                                <div className={`role-badge role-${user.role.toLowerCase()}`} style={{ display: 'inline-block' }}>
                                    {user.role}
                                </div>
                            </div>

                            <div className="form-group">
                                <label>Mobile</label>
                                <div style={{ fontSize: '1rem', fontWeight: '600' }}>{user.mobile}</div>
                            </div>

                            {user.email && (
                                <div className="form-group">
                                    <label>Email</label>
                                    <div style={{ fontSize: '1rem' }}>{user.email}</div>
                                </div>
                            )}

                            <div className="form-group">
                                <label>Username</label>
                                <div style={{ fontSize: '1rem', fontWeight: '600' }}>{user.username}</div>
                            </div>

                            <div className="form-group">
                                <label>Created On</label>
                                <div style={{ fontSize: '0.9rem', color: 'var(--text-muted)' }}>
                                    {new Date(user.createdAt).toLocaleDateString('en-IN')}
                                </div>
                            </div>

                            {currentUser.role === 'Owner' && user.id !== currentUser.id && (
                                <button className="btn btn-danger mt-2" onClick={onDelete}>
                                    Delete User
                                </button>
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>